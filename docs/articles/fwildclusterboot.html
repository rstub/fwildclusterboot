<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fwildclusterboot">
<title>fwildclusterboot • fwildclusterboot</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="fwildclusterboot">
<meta property="og:description" content="fwildclusterboot">
<meta property="og:image" content="https://s3alfisc.github.io/fwildclusterboot/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fwildclusterboot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.8</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/fwildclusterboot.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/seeds.html">How to set random seeds in fwildclusterboot</a>
    <a class="dropdown-item" href="../articles/WildBootTests.html">WildBootTests.jl</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/s3alfisc/fwildclusterboot/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="fwildclusterboot_files/kePrint-0.0.1/kePrint.js"></script><link href="fwildclusterboot_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>fwildclusterboot</h1>
                        <h4 data-toc-skip class="author">Alexander Fischer</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/s3alfisc/fwildclusterboot/blob/HEAD/vignettes/fwildclusterboot.Rmd" class="external-link"><code>vignettes/fwildclusterboot.Rmd</code></a></small>
      <div class="d-none name"><code>fwildclusterboot.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://s3alfisc.github.io/fwildclusterboot/">fwildclusterboot</a></span><span class="op">)</span></code></pre></div>
<p>The <code>fwildclusterboot</code> package implements the “fast” wild cluster bootstrap algorithm developed in Roodman et al (2019) for regression objects in R. The “fast” algorithm makes it feasible to calculate test statistics based on a large number of bootstrap draws even for large samples - as long as the number of bootstrapping clusters is not too large.</p>
<p>For linear regression models, <code>fwildclusterboot</code> supports almost all features of Stata’s <code>boottest</code> package. This means that a set of different bootstrap distributions, regression weights, fixed effects, and both restricted (WCR) and unrestricted (WCU) bootstrap inference are supported. The main difference is that it currently only supports univariate hypothesis tests of regression paramters of the form <span class="math inline">\(H_{0}: R\beta = r\)</span> vs <span class="math inline">\(H_{1}: R\beta \neq r\)</span>, where r is scalar.</p>
<p>Further, <code>fwildclusterboot</code> serves as an R port to <a href="https://github.com/droodman/WildBootTests.jl" class="external-link">WildBootTests.jl</a>, which implements the fast wild cluster bootstrap in Julia at extreme speed. Beyond being significantly faster than <code>fwildclusterboot's</code> native R implementation of the wild cluster bootstrap for OLS (in particular for more demanding problems), <code>WildBootTests.jl</code> offers support for the WRE bootstrap for IV models (<a href="https://www.tandfonline.com/doi/abs/10.1198/jbes.2009.07221" class="external-link">(Davidson &amp; MacKinnon, 2010)</a>) and functionality for tests of multiple hypothesis.</p>
<p>A description of the “fast” algorithm is beyond the scope of this vignette. It is very clearly presented in <a href="https://econpapers.repec.org/paper/qedwpaper/1406.htm" class="external-link">Roodman et al. (2019)</a>. For technical details of the implementation in <code>fwildclusterboot</code>, have a look at the <code>technical vignette</code> (tba).</p>
<div class="section level2">
<h2 id="the-boottest-function">The <code>boottest()</code> function<a class="anchor" aria-label="anchor" href="#the-boottest-function"></a>
</h2>
<p>The <code>fwildclusterboot</code> package consists of one key function, <code><a href="../reference/boottest.html">boottest()</a></code>. It implements the fast wild bootstrap and works with regression objects of type <code>lm</code>, <code>felm</code> and <code>fixest</code> from base R and the <code>lfe</code> and <code>fixest</code> packages.</p>
<p>To start, we create a random data set with two cluster variables (group_id1 &amp; group_id2), two fixed effects and a set of covariates. The <code>icc_</code> arguments control the cluster variable’s intra-cluster correlation.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># load data set voters included in fwildclusterboot</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">voters</span><span class="op">)</span>

<span class="co"># estimate the regression model via lm</span>
<span class="va">lm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">proposition_vote</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">ideology1</span> <span class="op">+</span> <span class="va">log_income</span> <span class="op">+</span> <span class="va">Q1_immigration</span> , data <span class="op">=</span> <span class="va">voters</span><span class="op">)</span>

<span class="co"># model with interaction</span>
<span class="va">lm_fit_interact</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">proposition_vote</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">ideology1</span> <span class="op">+</span> <span class="va">log_income</span><span class="op">:</span><span class="va">Q1_immigration</span> , data <span class="op">=</span> <span class="va">voters</span><span class="op">)</span></code></pre></div>
<p>The <code><a href="../reference/boottest.html">boottest()</a></code> function has 4 required and several optional arguments. The required objects are</p>
<ul>
<li>object: a regression object of type <code>lm</code>, <code>fixest</code> or <code>felm</code>
</li>
<li>clustid: a character vector that defines the clustering variables</li>
<li>param: a character vector of length one - the model parameter to be tested</li>
<li>B: the number of bootstrap iterations</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># boottest on an object of type lm</span>
<span class="va">boot_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, clustid <span class="op">=</span> <span class="st">"group_id1"</span>, param <span class="op">=</span> <span class="st">"treatment"</span>, B <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span></code></pre></div>
<p>To tests for an interaction, it is important to use the coefficient names that are internally created by the modeling function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#names(coef(lm_fit_interact))</span>
<span class="va">boot_lm_interact</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit_interact</span>, clustid <span class="op">=</span> <span class="st">"group_id1"</span>, param <span class="op">=</span> <span class="st">"log_income:Q1_immigration1"</span>, B <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span></code></pre></div>
<p><code><a href="../reference/boottest.html">boottest()</a></code> further allows for multivariable tests. Suppose we’re interested in testing the null hypothesis <span class="math inline">\(0.6*treatment + 0.2*ideology1 = 0.02\)</span>. To test such a hypothesis, one would have to specify the hypothesis via the <code>param</code>, <code>R</code> and <code>r</code> arguments:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_multi</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, clustid <span class="op">=</span> <span class="st">"group_id1"</span>, param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment"</span>, <span class="st">"ideology1"</span><span class="op">)</span>, R <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.2</span><span class="op">)</span>, r <span class="op">=</span> <span class="fl">0.02</span>, B <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span></code></pre></div>
<p>To access the estimation results, <code><a href="../reference/boottest.html">boottest()</a></code> comes with <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code>, <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> and <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> methods. The <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code> method returns the estimation results in a data.frame. <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary()</a></code> returns additional information on top of the test statistics reported by <code><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy()</a></code>. The<code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> method enables the use of output formatting tools from the <code>modelsummary</code> package.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># fwildclusterboot's internal summary() method</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">boot_lm</span><span class="op">)</span>
<span class="co">#&gt; boottest.lm(object = lm_fit, param = "treatment", B = 9999, clustid = "group_id1")</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;  Hypothesis: 1*treatment = 0</span>
<span class="co">#&gt;  Observations: 300</span>
<span class="co">#&gt;   Bootstr. Type: rademacher</span>
<span class="co">#&gt;  Clustering: 1-way</span>
<span class="co">#&gt;  Confidence Sets: 95%</span>
<span class="co">#&gt;  Number of Clusters: 40</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              term estimate statistic p.value conf.low conf.high</span>
<span class="co">#&gt; 1 1*treatment = 0    0.073     3.709   0.001    0.034     0.113</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">boot_multi</span><span class="op">)</span>
<span class="co">#&gt; boottest.lm(object = lm_fit, param = c("treatment", "ideology1"), </span>
<span class="co">#&gt;     B = 9999, clustid = "group_id1", R = c(0.6, 0.2), r = 0.02)</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;  Hypothesis: 0.6*treatment+0.2*ideology1 = 0.02</span>
<span class="co">#&gt;  Observations: 300</span>
<span class="co">#&gt;   Bootstr. Type: rademacher</span>
<span class="co">#&gt;  Clustering: 1-way</span>
<span class="co">#&gt;  Confidence Sets: 95%</span>
<span class="co">#&gt;  Number of Clusters: 40</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;                                 term estimate statistic p.value conf.low</span>
<span class="co">#&gt; 1 0.6*treatment+0.2*ideology1 = 0.02    0.048     2.346   0.025    0.023</span>
<span class="co">#&gt;   conf.high</span>
<span class="co">#&gt; 1     0.072</span>

<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"modelsummary"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># summary via the modelsummary package</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/modelsummary/" class="external-link">modelsummary</a></span><span class="op">)</span>
  <span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/msummary.html" class="external-link">msummary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">boot_lm</span>, <span class="va">boot_lm_interact</span><span class="op">)</span>, 
            estimate <span class="op">=</span> <span class="st">"{estimate} ({p.value})"</span>, 
           statistic <span class="op">=</span> <span class="st">"[{conf.low}, {conf.high}]"</span><span class="op">)</span>  
<span class="op">}</span>
<span class="co">#&gt; Loading required namespace: modelsummary</span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
<th style="text-align:center;">
Model 2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1*treatment = 0
</td>
<td style="text-align:center;">
0.073 (0.001)
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:center;">
[0.034, 0.113]
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left;">
1*log_income × Q1_immigration1 = 0
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
-0.038 (0.000)
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[-0.056, -0.019]
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
300
</td>
<td style="text-align:center;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.316
</td>
<td style="text-align:center;">
0.339
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
0.311
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
-82.1
</td>
<td style="text-align:center;">
-92.2
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
-30.2
</td>
<td style="text-align:center;">
-40.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
55.025
</td>
<td style="text-align:center;">
60.102
</td>
</tr>
</tbody>
</table>
<p>A <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> method allows the user to inspect the bootstrap t-statistics:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">boot_lm</span><span class="op">)</span></code></pre></div>
<p><img src="fwildclusterboot_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<!-- A note on the output in `tidy()` and `summary()`: -->
<div class="section level3">
<h3 id="multiway-clustering">Multiway Clustering<a class="anchor" aria-label="anchor" href="#multiway-clustering"></a>
</h3>
<p>The <code><a href="../reference/boottest.html">boottest()</a></code> function supports clustering of any dimension. E.g. for two-way clustering, one simply needs to specify the names of the cluster variables in a character vector.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, param <span class="op">=</span> <span class="st">"treatment"</span>, B <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">boot_lm</span><span class="op">)</span>
<span class="co">#&gt; boottest.lm(object = lm_fit, param = "treatment", B = 9999, clustid = c("group_id1", </span>
<span class="co">#&gt;     "group_id2"))</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;  Hypothesis: 1*treatment = 0</span>
<span class="co">#&gt;  Observations: 300</span>
<span class="co">#&gt;   Bootstr. Type: rademacher</span>
<span class="co">#&gt;  Clustering: 2-way</span>
<span class="co">#&gt;  Confidence Sets: 95%</span>
<span class="co">#&gt;  Number of Clusters: 40 20 251</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              term estimate statistic p.value conf.low conf.high</span>
<span class="co">#&gt; 1 1*treatment = 0    0.073     3.845   0.004    0.031     0.115</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-heteroskedastic-bootstrap">The Heteroskedastic Bootstrap<a class="anchor" aria-label="anchor" href="#the-heteroskedastic-bootstrap"></a>
</h3>
<p>If you drop the <code>clustid</code> argument, <code><a href="../reference/boottest.html">boottest()</a></code> will run a heteroskedasticity robust wild bootstrap via the ‘R-lean’ algorithm. At the moment, the null hypothesis is always imposed, only Rademacher and Webb weights are supported, and no confidence intervals are computed. As all algorithms in <code>fwildclusterboot</code>, p-values are calculated based on pivotal t-statistics.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, param <span class="op">=</span> <span class="st">"treatment"</span>, B <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">boot_lm</span><span class="op">)</span>
<span class="co">#&gt; boottest.lm(object = lm_fit, param = "treatment", B = 9999)</span>
<span class="co">#&gt;  </span>
<span class="co">#&gt;  Hypothesis: 1*treatment = 0</span>
<span class="co">#&gt;  Observations: 300</span>
<span class="co">#&gt;   Bootstr. Type: rademacher</span>
<span class="co">#&gt;  Clustering: 0-way</span>
<span class="co">#&gt;  Confidence Sets: 95%</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;              term estimate statistic p.value conf.low conf.high</span>
<span class="co">#&gt; 1 1*treatment = 0    0.073     3.096   0.002       NA        NA</span>
<span class="va">boot_lm</span><span class="op">$</span><span class="va">boot_algo</span>
<span class="co">#&gt; [1] "R-lean"</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="choice-of-bootstrap-weights">Choice of Bootstrap Weights<a class="anchor" aria-label="anchor" href="#choice-of-bootstrap-weights"></a>
</h3>
<p>Furthermore, the user can choose among four different weighting distribution via the <code>type</code> argument: Rademacher, Mammen, Normal and Webb. By default, <code><a href="../reference/boottest.html">boottest()</a></code> uses the Rademacher distribution.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_lm_rade</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, 
                    param <span class="op">=</span> <span class="st">"treatment"</span>, 
                    B <span class="op">=</span> <span class="fl">999</span>,
                    type <span class="op">=</span> <span class="st">"rademacher"</span><span class="op">)</span>
<span class="va">boot_lm_webb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, 
                    param <span class="op">=</span> <span class="st">"treatment"</span>, 
                    B <span class="op">=</span> <span class="fl">999</span>,
                    type <span class="op">=</span> <span class="st">"webb"</span><span class="op">)</span>

<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"modelsummary"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/modelsummary/" class="external-link">modelsummary</a></span><span class="op">)</span>
  <span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/msummary.html" class="external-link">msummary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">boot_lm_rade</span>, <span class="va">boot_lm_webb</span><span class="op">)</span>, 
          estimate <span class="op">=</span> <span class="st">"{estimate} ({p.value})"</span>, 
         statistic <span class="op">=</span> <span class="st">"[{conf.low}, {conf.high}]"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
<th style="text-align:center;">
Model 2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1*treatment = 0
</td>
<td style="text-align:center;">
0.073 (0.003)
</td>
<td style="text-align:center;">
0.073 (0.006)
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.029, 0.117]
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.028, 0.114]
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
300
</td>
<td style="text-align:center;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.316
</td>
<td style="text-align:center;">
0.316
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
0.288
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
-82.1
</td>
<td style="text-align:center;">
-82.1
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
-30.2
</td>
<td style="text-align:center;">
-30.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
55.025
</td>
<td style="text-align:center;">
55.025
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="other-function-arguments">Other function arguments<a class="anchor" aria-label="anchor" href="#other-function-arguments"></a>
</h3>
<p>Via the function argument <code>sign_level</code>, the user can control the significance level of the test. The default value is sign_level = 0.05, which corresponds to a 95% confindence interval.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_lm_5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span><span class="op">)</span>,
                    param <span class="op">=</span> <span class="st">"treatment"</span>, B <span class="op">=</span> <span class="fl">9999</span>, 
                    sign_level <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span>
<span class="va">boot_lm_10</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span><span class="op">)</span>,
                    param <span class="op">=</span> <span class="st">"treatment"</span>, B <span class="op">=</span> <span class="fl">9999</span>, 
                    sign_level <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span>

<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"modelsummary"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/modelsummary/" class="external-link">modelsummary</a></span><span class="op">)</span>
  <span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/msummary.html" class="external-link">msummary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">boot_lm_5</span>, <span class="va">boot_lm_10</span><span class="op">)</span>, 
          estimate <span class="op">=</span> <span class="st">"{estimate} ({p.value})"</span>, 
         statistic <span class="op">=</span> <span class="st">"[{conf.low}, {conf.high}]"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
<th style="text-align:center;">
Model 2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1*treatment = 0
</td>
<td style="text-align:center;">
0.073 (0.001)
</td>
<td style="text-align:center;">
0.073 (0.001)
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.032, 0.113]
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.040, 0.106]
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
300
</td>
<td style="text-align:center;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.316
</td>
<td style="text-align:center;">
0.316
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
0.288
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
-82.1
</td>
<td style="text-align:center;">
-82.1
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
-30.2
</td>
<td style="text-align:center;">
-30.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
55.025
</td>
<td style="text-align:center;">
55.025
</td>
</tr>
</tbody>
</table>
<p>In the case of multiway clustering, the user might want to specify the bootstrap clustering level. By default, boottest chooses the clustering level with the highest number of clusters as <code>bootcluster = "max"</code>. Other choices are the minimum cluster, or independent clustering variables.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_lm1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, 
                    param <span class="op">=</span> <span class="st">"treatment"</span>,
                    B <span class="op">=</span> <span class="fl">9999</span>, 
                    bootcluster <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span>

<span class="va">boot_lm2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, 
                    param <span class="op">=</span> <span class="st">"treatment"</span>,
                    B <span class="op">=</span> <span class="fl">9999</span>, 
                    bootcluster <span class="op">=</span> <span class="st">"group_id1"</span><span class="op">)</span>

<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"modelsummary"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/modelsummary/" class="external-link">modelsummary</a></span><span class="op">)</span>
  <span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/msummary.html" class="external-link">msummary</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">boot_lm1</span>, <span class="va">boot_lm2</span><span class="op">)</span>, 
          estimate <span class="op">=</span> <span class="st">"{estimate} ({p.value})"</span>, 
         statistic <span class="op">=</span> <span class="st">"[{conf.low}, {conf.high}]"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
<th style="text-align:center;">
Model 2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1*treatment = 0
</td>
<td style="text-align:center;">
0.073 (0.005)
</td>
<td style="text-align:center;">
0.073 (0.007)
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.031, 0.110]
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.028, 0.115]
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
300
</td>
<td style="text-align:center;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.316
</td>
<td style="text-align:center;">
0.316
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
0.288
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
-82.1
</td>
<td style="text-align:center;">
-82.1
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
-30.2
</td>
<td style="text-align:center;">
-30.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
55.025
</td>
<td style="text-align:center;">
55.025
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="fixed-effects">Fixed Effects<a class="anchor" aria-label="anchor" href="#fixed-effects"></a>
</h3>
<p>Last, <code><a href="../reference/boottest.html">boottest()</a></code> supports out-projection of fixed effects in the estimation stage via <code><a href="https://rdrr.io/pkg/lfe/man/felm.html" class="external-link">lfe::felm()</a></code> and <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">fixest::feols()</a></code>. Within the bootstrap, the user can choose to project out <em>only one</em> fixed effect, which can be set via the <code>fe</code> function argument. All other fixed effects specified in either <code><a href="https://rdrr.io/pkg/lfe/man/felm.html" class="external-link">felm()</a></code> or <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols()</a></code> are treated as sets of binary regressors.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"fixest"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># estimate the regression model via feols</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lrberge.github.io/fixest/" class="external-link">fixest</a></span><span class="op">)</span>
  <span class="va">feols_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span><span class="va">proposition_vote</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">ideology1</span> <span class="op">+</span> <span class="va">log_income</span> <span class="op">|</span> <span class="va">Q1_immigration</span> , data <span class="op">=</span> <span class="va">voters</span><span class="op">)</span>
  <span class="va">boot_feols</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">feols_fit</span>, 
                         clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
                         param <span class="op">=</span> <span class="st">"treatment"</span>, 
                         B <span class="op">=</span> <span class="fl">9999</span>, 
                         fe <span class="op">=</span> <span class="st">"Q1_immigration"</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; Loading required namespace: fixest</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="the-subcluster-bootstrap">The Subcluster Bootstrap<a class="anchor" aria-label="anchor" href="#the-subcluster-bootstrap"></a>
</h3>
<p>In the case of few treated clusters, <a href="https://academic.oup.com/ectj/article-abstract/21/2/114/5078969" class="external-link">MacKinnon and Webb (2018)</a> suggest to use subclusters to form the bootstrap distribution. <code><a href="../reference/boottest.html">boottest()</a></code> allows the user to specify subclusters via the <code>bootcluster</code> argument.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>,
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, 
                    param <span class="op">=</span> <span class="st">"treatment"</span>, 
                    B <span class="op">=</span> <span class="fl">9999</span>, 
                    bootcluster <span class="op">=</span> <span class="st">"min"</span><span class="op">)</span>
<span class="va">boot_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>,
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, 
                    param <span class="op">=</span> <span class="st">"treatment"</span>, 
                    B <span class="op">=</span> <span class="fl">9999</span>, 
                    bootcluster <span class="op">=</span> <span class="st">"group_id1"</span><span class="op">)</span>
<span class="va">boot_2var</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>,
                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"group_id2"</span><span class="op">)</span>, 
                    param <span class="op">=</span> <span class="st">"treatment"</span>, 
                    B <span class="op">=</span> <span class="fl">9999</span>, 
                    bootcluster <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span>, <span class="st">"Q1_immigration"</span><span class="op">)</span><span class="op">)</span>

<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"modelsummary"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://vincentarelbundock.github.io/modelsummary/" class="external-link">modelsummary</a></span><span class="op">)</span>
  <span class="fu"><a href="https://vincentarelbundock.github.io/modelsummary/reference/msummary.html" class="external-link">msummary</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">boot_min</span>, <span class="va">boot_2var</span><span class="op">)</span>, 
         estimate <span class="op">=</span> <span class="st">"{estimate} ({p.value})"</span>, 
         statistic <span class="op">=</span> <span class="st">"[{conf.low}, {conf.high}]"</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
Model 1
</th>
<th style="text-align:center;">
Model 2
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1*treatment = 0
</td>
<td style="text-align:center;">
0.073 (0.003)
</td>
<td style="text-align:center;">
0.073 (0.008)
</td>
</tr>
<tr>
<td style="text-align:left;box-shadow: 0px 1px">
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.032, 0.111]
</td>
<td style="text-align:center;box-shadow: 0px 1px">
[0.028, 0.118]
</td>
</tr>
<tr>
<td style="text-align:left;">
Num.Obs.
</td>
<td style="text-align:center;">
300
</td>
<td style="text-align:center;">
300
</td>
</tr>
<tr>
<td style="text-align:left;">
R2
</td>
<td style="text-align:center;">
0.316
</td>
<td style="text-align:center;">
0.316
</td>
</tr>
<tr>
<td style="text-align:left;">
R2 Adj.
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
0.288
</td>
</tr>
<tr>
<td style="text-align:left;">
AIC
</td>
<td style="text-align:center;">
-82.1
</td>
<td style="text-align:center;">
-82.1
</td>
</tr>
<tr>
<td style="text-align:left;">
BIC
</td>
<td style="text-align:center;">
-30.2
</td>
<td style="text-align:center;">
-30.2
</td>
</tr>
<tr>
<td style="text-align:left;">
Log.Lik.
</td>
<td style="text-align:center;">
55.025
</td>
<td style="text-align:center;">
55.025
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="regression-weights-weighted-least-squares-wls">Regression Weights / Weighted Least Squares (WLS)<a class="anchor" aria-label="anchor" href="#regression-weights-weighted-least-squares-wls"></a>
</h3>
<p>If regression weights are specified in the estimation stage via <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols()</a></code> or <code><a href="https://rdrr.io/pkg/lfe/man/felm.html" class="external-link">felm()</a></code>, <code><a href="../reference/boottest.html">boottest()</a></code> incorporates the weights into the bootstrap inference:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># regression with weights / WLS</span>
<span class="va">lm_w_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">proposition_vote</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">ideology1</span> <span class="op">+</span> <span class="va">log_income</span>, weights <span class="op">=</span> <span class="va">voters</span><span class="op">$</span><span class="va">weights</span>, data <span class="op">=</span> <span class="va">voters</span><span class="op">)</span>

<span class="va">boot_w_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_w_fit</span>, 
                       clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
                       param <span class="op">=</span> <span class="st">"treatment"</span>, 
                       B <span class="op">=</span> <span class="fl">9999</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parallel-execution">Parallel Execution<a class="anchor" aria-label="anchor" href="#parallel-execution"></a>
</h3>
<p>A major bottleneck for the performance of <code><a href="../reference/boottest.html">boottest()</a></code> is a large matrix multiplication, which includes the bootstrap weights matrix on the right. In order to speed up the computation, this multiplication calls the c++ Eigen library, which allows for parallelization of dense matrix products. By default, <code><a href="../reference/boottest.html">boottest()</a></code> uses one thread. Note that there is a cost of parallelization due to communication overhead. As a rule of thumb, if <code><a href="../reference/boottest.html">boottest()</a></code> takes more than 10 seconds per execution, using a second thread might speed up the bootstrap.</p>
<p>The number of threads can be specified via the <code>nthreads</code> argument of <code><a href="../reference/boottest.html">boottest()</a></code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                       clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
                       param <span class="op">=</span> <span class="st">"treatment"</span>, 
                       B <span class="op">=</span> <span class="fl">9999</span>, 
                       nthreads <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="running-the-wild-cluster-bootstrap-via-wildboottests-jl">Running the wild cluster bootstrap via WildBootTests.jl<a class="anchor" aria-label="anchor" href="#running-the-wild-cluster-bootstrap-via-wildboottests-jl"></a>
</h2>
<p><code>fwildclusterboot</code> serves as an R port to <a href="https://github.com/droodman/WildBootTests.jl" class="external-link">WildBootTests.jl</a> package.</p>
<p>For guidance on how to install <code>Julia</code> and <code>WildBootTests.jl</code> and how to connect R and Julia, please take a look at the <a href="WildBootTests.html">running WildBootTests.jl through fwildclusterboot</a> vignette.</p>
<p>You can tell <code><a href="../reference/boottest.html">boottest()</a></code> to run <code>WildBootTests.jl</code> by using the <code>boot_algo</code> function argument:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">boot_lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
                       clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
                       param <span class="op">=</span> <span class="st">"treatment"</span>, 
                       B <span class="op">=</span> <span class="fl">9999</span>, 
                       boot_algo <span class="op">=</span> <span class="st">"WildBootTests.jl"</span><span class="op">)</span>
<span class="fu">generics</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">boot_lm</span><span class="op">)</span>
<span class="co">#             term   estimate statistic    p.value   conf.low conf.high</span>
<span class="co">#1 1*treatment = 0 0.07290769  3.709435 0.00060006 0.03326969 0.1134117</span></code></pre></div>
<p>The seed used within Julia is linked to R’s global seed, which you can set through the familiar <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> function.</p>
<p>If you decide to run all your bootstraps through <code>WildBootTests.jl</code>, you can set a global variable via</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/setBoottest_boot_algo.html">setBoottest_boot_algo</a></span><span class="op">(</span><span class="st">"WildBootTests.jl"</span><span class="op">)</span></code></pre></div>
<p>Calling <code><a href="../reference/boottest.html">boottest()</a></code> without specifying <code>boot_algo = "WildBootTests.jl"</code> will now automatically run the bootstrap through <code>WildBootTests.jl</code>.</p>
<div class="section level3">
<h3 id="the-wre-bootstrap-for-iv-models">The WRE bootstrap for IV models<a class="anchor" aria-label="anchor" href="#the-wre-bootstrap-for-iv-models"></a>
</h3>
<p>Through <code>WildBootTests.jl</code>, <code>fwildclusterboot</code> supports the WRE bootstrap by <a href="https://www.tandfonline.com/doi/abs/10.1198/jbes.2009.07221" class="external-link">Davidson &amp; MacKinnon, 2010</a> for IV (instrumental variables) models for objects of type <code>ivreg</code> via the <code><a href="../reference/boottest.html">boottest()</a></code> function:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://john-d-fox.github.io/ivreg/" class="external-link">ivreg</a></span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SchoolingReturns"</span>, package <span class="op">=</span> <span class="st">"ivreg"</span><span class="op">)</span>
      
<span class="co"># drop all NA values from SchoolingReturns</span>
<span class="va">SchoolingReturns</span> <span class="op">&lt;-</span> <span class="va">SchoolingReturns</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/colSums.html" class="external-link">rowMeans</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">SchoolingReturns</span>, <span class="va">is.na</span><span class="op">)</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span>,<span class="op">]</span>
<span class="va">ivreg_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://john-d-fox.github.io/ivreg//reference/ivreg.html" class="external-link">ivreg</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span> <span class="op">~</span> <span class="va">education</span> <span class="op">+</span> <span class="va">age</span> <span class="op">+</span> <span class="va">ethnicity</span> <span class="op">+</span> <span class="va">smsa</span> <span class="op">+</span> <span class="va">south</span> <span class="op">+</span> <span class="va">parents14</span> <span class="op">|</span>
                           <span class="va">nearcollege</span> <span class="op">+</span> <span class="va">age</span>  <span class="op">+</span> <span class="va">ethnicity</span> <span class="op">+</span> <span class="va">smsa</span> <span class="op">+</span> <span class="va">south</span> <span class="op">+</span> <span class="va">parents14</span>, data <span class="op">=</span> <span class="va">SchoolingReturns</span><span class="op">)</span>

      
<span class="va">boot_ivreg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">ivreg_fit</span>,
                        B <span class="op">=</span> <span class="fl">999</span>,
                        param <span class="op">=</span> <span class="st">"education"</span>,
                        clustid <span class="op">=</span> <span class="st">"kww"</span>,
                        type <span class="op">=</span> <span class="st">"mammen"</span>,
                        impose_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu">generics</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">boot_ivreg</span><span class="op">)</span>
<span class="co">#              term  estimate statistic   p.value    conf.low conf.high</span>
<span class="co"># 1 1*education = 0 0.0638822  1.043969 0.2482482 -0.03152655 0.2128746</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="tests-of-multiple-joint-hypotheses-q-1">Tests of multiple joint hypotheses (q &gt; 1)<a class="anchor" aria-label="anchor" href="#tests-of-multiple-joint-hypotheses-q-1"></a>
</h3>
<p>Through <code>WildBootTests.jl</code>, you can also test multiple joint hypotheses via the <code><a href="../reference/mboottest.html">mboottest()</a></code> function. With minor differences, <code>mboottest()'s</code> syntax largely mirrors <code><a href="../reference/boottest.html">boottest()</a></code>.</p>
<p>To jointly test the null hypothesis <span class="math inline">\(H_0: treatment = 0 \text{ and } ideology1 = 0\)</span> vs <span class="math inline">\(H_0: treatment \neq 0 \text{ and } ideology1 \neq 0\)</span> via a wild cluster bootstrap, you can run</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jepusto/clubSandwich" class="external-link">clubSandwich</a></span><span class="op">)</span>
<span class="va">R</span> <span class="op">&lt;-</span> <span class="fu">clubSandwich</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/clubSandwich/man/constraint_matrices.html" class="external-link">constrain_zero</a></span><span class="op">(</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">lm_fit</span><span class="op">)</span><span class="op">)</span>
<span class="va">wboottest</span> <span class="op">&lt;-</span> 
<span class="fu"><a href="../reference/mboottest.html">mboottest</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">lm_fit</span>, 
             clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
             B <span class="op">=</span> <span class="fl">999</span>, 
             R <span class="op">=</span> <span class="va">R</span><span class="op">)</span>
<span class="fu">generics</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">wboottest</span><span class="op">)</span>
<span class="co">#   teststat p_val</span>
<span class="co"># 1 8.469086     0</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="miscellanea">Miscellanea<a class="anchor" aria-label="anchor" href="#miscellanea"></a>
</h2>
<!-- ## Why does `boottest()` not compute standard errors? -->
<!-- ## A note on performance -->
<!-- ## Inversion of p-values -->
<!-- ### How it works: make use of linearity of both the numerator and J -->
<!-- The starting point of this section are equations (56, 58 and 62) in Roodman et al. They show that once can write the numerator as (eq. 56) -->
<!-- $$ -->
<!--   R(\hat{\beta}^{*} - \tilde{\beta}) = \{S_{c_{*}} [WDXAR' :* \tilde{u}] \}' v^{*}. -->
<!-- $$ -->
<!-- The denominator can be written as (eq. 60) -->
<!-- $$ -->
<!-- $$ -->
<!-- where the object $K$ can be computed as  -->
<!-- $$ -->
<!-- $$ -->
<!-- For univariate hypotheses, both numerator and J are linear in $r$.  -->
<!-- Note that several objects used in the computation of both numerator and J can be written as $\ü :* A$ or $\ü * A$, where $A$ is and $ü$ is .... All derivations are shown for the first case, while the main conclusions apply to the second as well.  -->
<!-- First, for the WCU, it holds that  -->
<!-- \begin{align} -->
<!--     \ü :* A &= (Y - X'\beta) :* A \\ -->
<!--       &= Y :* A - X'\beta :* A \\ -->
<!--       &= Y :* A - X'(X'X)^{-1}X Y :* A \\ -->
<!--       &=  ((1 :- P_{x}) Y) :* A  -->
<!-- \end{align} -->
<!-- For the WCR, the analogous derivation are slightly more complicated:  -->
<!-- \begin{align} -->
<!--   \tilde{u} :* A &= (Y_{r} - X_{r}'\beta_{r}) :* A \\ -->
<!--           &= Y_{r} :* A - X_{r}'\beta_{r} :* A \\ -->
<!--           &= Y_{r} :* A - X_{r}'(X_{r}'X_{r})^{-1}X_{r} Y_{r} :* A \\ -->
<!--           &= Y_{r} :* A - P_{xr} Y_{r} :* A \\ -->
<!-- \end{align} -->
<!-- Now, note that $Y_r = Y - X_0 r$, it follows that  -->
<!-- \begin{align} -->
<!--   \tilde{u} :* A &= Y_{r} :* A - P_{xr} Y_{r} :* A \\  -->
<!--             &= (Y - X_{0} r) :* A - P_{xr} (Y - X_{0} r) :* A \\ -->
<!--             &= Y :* A - X_{0} r :* A - (P_{xr} Y) :* A +  P_{xr}  X_{0} r :*A \\  -->
<!--             &=  Y :* A  - (P_{xr} Y) :* A - P_{xr}  X_{0} r :* A + X_{0} r :* A \\ -->
<!--             &= (Y - P_{xr} Y) :* A + (X_{0} r -P_{xr}  X_{0} r) :* A \\  -->
<!--             &= (1 :- P_{xr})Y :* A + ((1 :- P_{xr})  X_{0}) :* A * r \\ -->
<!--             &= P + Q r -->
<!-- \end{align} -->
<!-- where  -->
<!-- $$ -->
<!--   P = (1 :- P_{xr})Y -->
<!-- $$ -->
<!-- and  -->
<!-- $$ -->
<!--   Q = ((1 :- P_{xr})  X_{0}). -->
<!-- $$ -->
<!-- Both quantities, $P$ and $Q$, are explicitely computed as such in the boot_algo2 function. Q summarizes all terms that vary in $r$, while P summarizes constant terms.  -->
<!-- Note that in the case of the WCU, $X_r = X$, $P_{xr} = P_{x}$, and $X_0$ is a vector of length N, containing zeros.  -->
<!-- Therefore, the following quantities need to be computed:  -->
<!-- + $X_r$ -->
<!-- + $P_{xr}$ -->
<!-- + $X_0$ -->
<!-- + several different object for $A$ -->
<!-- Based on these objects, one can e.g. compute -->
<!-- \begin{align} -->
<!-- S_{c, c*}[\tilde{u} :* A] &= S_{c, c*}[(1 :- P_{xr})Y :* A] + S_{c, c*}[((1 :- P_{xr})  X_{0}) :* A]  r \\ -->
<!-- &= P_{1} + Q_{1} r -->
<!-- \end{align} -->
<!-- For K, one can then write an expression of the form  -->
<!-- \begin{align} -->
<!--   K &= (P_1 + P_2 + P_3) + (Q_1 + Q_2 +   Q_3) r  -->
<!-- \end{align} -->
<!-- For $J$, it follows that  -->
<!-- \begin{align} -->
<!--   J = K v & = (P_1 + P_2 + P_3) v + (Q_1 + Q_2 +   Q_3) v \times r \\ -->
<!--   &= C + D \times r -->
<!-- \end{align} -->
<!-- For $J :* J$, it hence follows  -->
<!-- $$ -->
<!--   J :* J = C :* C  + 2 C :* D \times r + D :* D \times r^{2} -->
<!-- $$ -->
<!-- So, in short: one can simply compute C, D, CC, CD and DD once and then invert the p-value by searching over r.  -->
<!-- Again, note that for for the WCU, $X_0 = 0$, which implies that in the equations above, all elements in $Q$, $Q1$, $Q2$, $Q3$, $D$, $CD$ and $DD$ are zero. In consequence, for the WCU, the numerator can be computed as  -->
<!-- $$ -->
<!-- $$ -->
<!-- and the denominator is  -->
<!-- $$ -->
<!-- $$ -->
<!-- For the WCU, both numerator and denominator do not depend on $r$. -->
<!-- + why might confidence intervals differ for estimates based on `lm()`, `feols()` and `felm()`? -->
<div class="section level3">
<h3 id="a-sanity-check-if-fwildclusterbootboottest-works-as-intended">A sanity check if <code>fwildclusterboot::boottest()</code> works as intended<a class="anchor" aria-label="anchor" href="#a-sanity-check-if-fwildclusterbootboottest-works-as-intended"></a>
</h3>
<p>A sanity check to see if <code><a href="../reference/boottest.html">fwildclusterboot::boottest()</a></code> works as intended is to look at its <code>t_stat</code> return value. For both the WCR and WCU bootstrap, <code><a href="../reference/boottest.html">boottest()</a></code> re-calculates the “original” - hence non-bootstrapped - t-statistic from its input regression model. The t-stat computed in <code><a href="../reference/boottest.html">boottest()</a></code> and the t-stats reported by either <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols()</a></code> and <code><a href="https://rdrr.io/pkg/lfe/man/lfe-package.html" class="external-link">lfe()</a></code> under the same error clustering structure and small-sample adjustments should be <em>identical</em>. If you find that they differ, please report a bug <a href="https://github.com/s3alfisc/fwildclusterboot/issues" class="external-link">on github</a>. Note that <code>fwildclusterboot</code> explicitly tests for t-stat equality against <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">fixest::feols()</a></code> <a href="https://github.com/s3alfisc/fwildclusterboot/blob/master/inst/tinytest/test_small_sample_correction_tstat.R" class="external-link">here</a>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> 
<span class="fu">fwildclusterboot</span><span class="fu">:::</span><span class="fu"><a href="../reference/create_data.html">create_data</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">1000</span>, 
                               N_G1 <span class="op">=</span> <span class="fl">20</span>, 
                               icc1 <span class="op">=</span> <span class="fl">0.81</span>,
                               N_G2 <span class="op">=</span> <span class="fl">10</span>,
                               icc2 <span class="op">=</span> <span class="fl">0.01</span>, 
                               numb_fe1 <span class="op">=</span> <span class="fl">10</span>,
                               numb_fe2 <span class="op">=</span> <span class="fl">10</span>, 
                               seed <span class="op">=</span> <span class="fl">8769</span><span class="op">)</span>

<span class="co"># oneway clustering </span>
<span class="va">feols_fit</span> <span class="op">&lt;-</span> <span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols</a></span><span class="op">(</span><span class="va">proposition_vote</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">ideology1</span> <span class="op">+</span> <span class="va">log_income</span>,
                           data <span class="op">=</span> <span class="va">data</span>, 
                           cluster <span class="op">=</span> <span class="op">~</span><span class="va">group_id1</span>, 
                           ssc <span class="op">=</span> <span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/ssc.html" class="external-link">ssc</a></span><span class="op">(</span>adj <span class="op">=</span> <span class="cn">TRUE</span>, 
                                             cluster.adj <span class="op">=</span> <span class="cn">TRUE</span>, 
                                             cluster.df <span class="op">=</span> <span class="st">'conventional'</span><span class="op">)</span>
                           <span class="op">)</span>
        
<span class="va">feols_tstats</span> <span class="op">&lt;-</span> <span class="fu">fixest</span><span class="fu">::</span><span class="fu"><a href="https://lrberge.github.io/fixest/reference/coeftable.html" class="external-link">coeftable</a></span><span class="op">(</span><span class="va">feols_fit</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment"</span>, <span class="st">"log_income"</span>, <span class="st">"ideology1"</span><span class="op">)</span>, <span class="fl">3</span><span class="op">]</span>

<span class="va">boot_tstats</span> <span class="op">&lt;-</span> 
<span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"treatment"</span>, <span class="st">"log_income"</span>, <span class="st">"ideology1"</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="va">boot1</span> <span class="op">&lt;-</span> <span class="fu">fwildclusterboot</span><span class="fu">::</span><span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">feols_fit</span>, 
                                    clustid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group_id1"</span><span class="op">)</span>,
                                    B <span class="op">=</span> <span class="fl">999</span>, 
                                    param <span class="op">=</span> <span class="va">x</span>, 
                                    ssc <span class="op">=</span> <span class="fu">fwildclusterboot</span><span class="fu">::</span><span class="fu"><a href="../reference/boot_ssc.html">boot_ssc</a></span><span class="op">(</span>adj <span class="op">=</span> <span class="cn">TRUE</span>, 
                                                               cluster.adj <span class="op">=</span> <span class="cn">TRUE</span>, 
                                                               cluster.df <span class="op">=</span> <span class="st">'conventional'</span><span class="op">)</span>,  
                                    impose_null <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">t_stat</span>
<span class="op">}</span><span class="op">)</span>        

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">feols_tstats</span>, <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">boot_tstats</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feols tstat"</span>, <span class="st">"boottest tstat"</span><span class="op">)</span>
<span class="va">df</span>
<span class="co">#&gt;            feols tstat boottest tstat</span>
<span class="co">#&gt; treatment    0.9958071      0.9958071</span>
<span class="co">#&gt; log_income  -2.9129869     -2.9129869</span>
<span class="co">#&gt; ideology1    1.4169933      1.4169933</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="small-sample-corrections">Small Sample Corrections<a class="anchor" aria-label="anchor" href="#small-sample-corrections"></a>
</h3>
<p><code><a href="../reference/boottest.html">boottest()</a></code> offers several options for small sample adjustments via the <code>ssc</code> function argument which need to be specified via the <code><a href="../reference/boot_ssc.html">boot_ssc()</a></code> function. <code><a href="../reference/boot_ssc.html">boot_ssc()</a></code> has 4 arguments and is intentionally designed to mimic <code>fixest's</code> <code><a href="https://lrberge.github.io/fixest/reference/ssc.html" class="external-link">ssc()</a></code> function. For more information on the default choices and alternative options, see <code>?fwildclusterboot::boot_ssc()</code>.</p>
</div>
<div class="section level3">
<h3 id="memory-the-lean-implementation-of-the-wild-cluster-bootstrap">Memory &amp; the ‘lean’ implementation of the wild cluster bootstrap<a class="anchor" aria-label="anchor" href="#memory-the-lean-implementation-of-the-wild-cluster-bootstrap"></a>
</h3>
<p>Because the R-implementation of the fast algorithm is memory-intensive, <code>fwildclusterboot</code> further supports a Rcpp-based ‘lean’ implementation of the wild cluster bootstrap in case that memory demands get prohibitively large. In general, the ‘lean’ algorithm is much slower: its main feature is that it requires <em>much</em> less memory. The algorithm is equivalent to the ‘wild2’ algorithm in the “Fast &amp; Wild” paper by Roodman et al. Note that the implementation in <code>WildBootTests.jl</code> is, in general, very memory-efficient.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bench.r-lib.org/" class="external-link">bench</a></span><span class="op">)</span>

<span class="va">dt</span> <span class="op">&lt;-</span> <span class="fu">fwildclusterboot</span><span class="fu">:::</span><span class="fu"><a href="../reference/create_data.html">create_data</a></span><span class="op">(</span>
  N <span class="op">=</span> <span class="fl">10000</span>, 
  N_G1 <span class="op">=</span> <span class="fl">250</span>, 
  icc1 <span class="op">=</span> <span class="fl">0.01</span>, 
  N_G2 <span class="op">=</span> <span class="fl">10</span>, 
  icc2 <span class="op">=</span> <span class="fl">0.01</span>, 
  numb_fe1 <span class="op">=</span> <span class="fl">10</span>, 
  numb_fe2 <span class="op">=</span> <span class="fl">10</span>, 
  seed <span class="op">=</span> <span class="fl">7645</span>
<span class="op">)</span>

<span class="va">lm_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">proposition_vote</span> <span class="op">~</span> <span class="va">treatment</span> <span class="op">+</span> <span class="va">ideology1</span> <span class="op">+</span> <span class="va">log_income</span> <span class="op">+</span> <span class="va">Q1_immigration</span> , data <span class="op">=</span> <span class="va">dt</span><span class="op">)</span>

<span class="va">res</span> <span class="op">&lt;-</span> 
<span class="fu">bench</span><span class="fu">::</span><span class="fu"><a href="http://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span>
  <span class="st">"R"</span> <span class="op">=</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
           clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
           param <span class="op">=</span> <span class="st">"treatment"</span>, 
           B <span class="op">=</span> <span class="fl">9999</span>, 
           boot_algo <span class="op">=</span> <span class="st">"R"</span>, 
           nthreads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, 
  <span class="st">"R-lean"</span> <span class="op">=</span> <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
           clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
           param <span class="op">=</span> <span class="st">"treatment"</span>, 
           B <span class="op">=</span> <span class="fl">9999</span>, 
           boot_algo <span class="op">=</span> <span class="st">"R-lean"</span>, 
           nthreads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,
  <span class="st">"WildBootTests.jl"</span> <span class="op">=</span> 
    <span class="fu"><a href="../reference/boottest.html">boottest</a></span><span class="op">(</span><span class="va">lm_fit</span>, 
           clustid <span class="op">=</span> <span class="st">"group_id1"</span>, 
           param <span class="op">=</span> <span class="st">"treatment"</span>, 
           B <span class="op">=</span> <span class="fl">9999</span>, 
           boot_algo <span class="op">=</span> <span class="st">"WildBootTests.jl"</span><span class="op">)</span>, 
  iterations <span class="op">=</span> <span class="fl">1</span>, 
  check <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span>

<span class="va">res</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="treatment-of-invalid-test-statistics-for-multiway-clustering">Treatment of Invalid Test Statistics for multiway clustering<a class="anchor" aria-label="anchor" href="#treatment-of-invalid-test-statistics-for-multiway-clustering"></a>
</h3>
<p>In case of multi-way clustering, it is not guaranteed that the covariance matrix is positive definite, in which case the resulting bootstrap test statistics are invalid. <code><a href="../reference/boottest.html">boottest()</a></code> follows the implementation in STATA and deletes invalid tests statistics, and informs the user with a note.</p>
</div>
<div class="section level3">
<h3 id="on-the-handling-of-missing-values">On the handling of missing values<a class="anchor" aria-label="anchor" href="#on-the-handling-of-missing-values"></a>
</h3>
<p><code><a href="../reference/boottest.html">boottest()</a></code> retrieves both the design matrix <span class="math inline">\(X\)</span>, the dependent variable <span class="math inline">\(y\)</span> and the cluster variables from the input object of type <code>lm</code>, <code>fixest</code> or <code>felm</code>. Because <code><a href="../reference/boottest.html">boottest()</a></code> allows to add or delete clustering variables that are not employed in <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols()</a></code> and <code><a href="https://rdrr.io/pkg/lfe/man/felm.html" class="external-link">felm()</a></code>, it may occur that a cluster variable is added in <code><a href="../reference/boottest.html">boottest()</a></code> that is not included in the regression model, either as a cluster variable or covariate.</p>
<p>In this case, boottest by default deletes the respective rows in the dependent variable, design matrix and in the cluster variables. In consequence, estimation (in the modeling step) and inference (via <code><a href="../reference/boottest.html">boottest()</a></code>) are done on a different sample. <code><a href="../reference/boottest.html">boottest()</a></code> returns a warning.</p>
<p>This in turn has a consequence for the use of <code><a href="../reference/boottest.html">boottest()</a></code> and <code>modelsummary</code>. <code><a href="../reference/boottest.html">boottest()</a></code> simply calls the <code><a href="https://generics.r-lib.org/reference/glance.html" class="external-link">glance()</a></code> methods for objects of types <code>fixest</code>, <code>felm</code> and <code>lm</code> from the <code>broom</code> package, and therefore, the number of observations reported via <code><a href="https://vincentarelbundock.github.io/modelsummary/reference/msummary.html" class="external-link">msummary()</a></code> is the number of observations used in the modeling stage.</p>
<p>The default behavior of <code><a href="../reference/boottest.html">boottest()</a></code> - to delete missings with a warning - can be set off via the <code>na_omit</code> function argument. If <code>na_omit</code> is set to FALSE, <code><a href="../reference/boottest.html">boottest()</a></code> will not allow for missing values in the added cluster variables and throw an error.</p>
</div>
<div class="section level3">
<h3 id="a-note-of-caution">A note of caution<a class="anchor" aria-label="anchor" href="#a-note-of-caution"></a>
</h3>
<p>The <code><a href="https://lrberge.github.io/fixest/reference/feols.html" class="external-link">feols()</a></code> function from <code>fixest</code> introduces several useful formula shortcuts. E.g. one can fit several regressions at once. All these advanced formula tools are not supported in <code><a href="../reference/boottest.html">boottest()</a></code>. <code><a href="../reference/boottest.html">boottest()</a></code> tries to catch any use of advanced formulas, but might fail to return errors in some cases.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alexander Fischer, David Roodman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
